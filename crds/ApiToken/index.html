<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>ApiToken - API Operator for Quay</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">API Operator for Quay</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">User Guide</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Custom Resources</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Operator Custom Resources</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">ApiToken</a>
</li>
                                    
<li>
    <a href="../Application/" class="dropdown-item">Application</a>
</li>
                                    
<li>
    <a href="../DefaultPerm/" class="dropdown-item">DefaultPerm</a>
</li>
                                    
<li>
    <a href="../DockerToken/" class="dropdown-item">DockerToken</a>
</li>
                                    
<li>
    <a href="../FirstUser/" class="dropdown-item">FirstUser</a>
</li>
                                    
<li>
    <a href="../ManifestLabel/" class="dropdown-item">ManifestLabel</a>
</li>
                                    
<li>
    <a href="../Message/" class="dropdown-item">Message</a>
</li>
                                    
<li>
    <a href="../Notification/" class="dropdown-item">Notification</a>
</li>
                                    
<li>
    <a href="../OrganizationPrune/" class="dropdown-item">OrganizationPrune</a>
</li>
                                    
<li>
    <a href="../Organization/" class="dropdown-item">Organization</a>
</li>
                                    
<li>
    <a href="../ProxyCache/" class="dropdown-item">ProxyCache</a>
</li>
                                    
<li>
    <a href="../Quota/" class="dropdown-item">Quota</a>
</li>
                                    
<li>
    <a href="../Repository/" class="dropdown-item">Repository</a>
</li>
                                    
<li>
    <a href="../RepositoryMirror/" class="dropdown-item">RepositoryMirror</a>
</li>
                                    
<li>
    <a href="../RepositoryPrune/" class="dropdown-item">RepositoryPrune</a>
</li>
                                    
<li>
    <a href="../Robot/" class="dropdown-item">Robot</a>
</li>
                                    
<li>
    <a href="../Tag/" class="dropdown-item">Tag</a>
</li>
                                    
<li>
    <a href="../TeamLdap/" class="dropdown-item">TeamLdap</a>
</li>
                                    
<li>
    <a href="../TeamOidc/" class="dropdown-item">TeamOidc</a>
</li>
                                    
<li>
    <a href="../Team/" class="dropdown-item">Team</a>
</li>
                                    
<li>
    <a href="../User/" class="dropdown-item">User</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Developer Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../developer-guide/" class="dropdown-item">Developer Guide</a>
</li>
                                    
<li>
    <a href="../../developer-guide/tools/" class="dropdown-item">Tools</a>
</li>
                                    
<li>
    <a href="../../developer-guide/building/" class="dropdown-item">Building</a>
</li>
                                    
<li>
    <a href="../../developer-guide/deploying/" class="dropdown-item">Deploying</a>
</li>
                                    
<li>
    <a href="../../developer-guide/testing/" class="dropdown-item">Testing</a>
</li>
                                    
<li>
    <a href="../../developer-guide/releasing/" class="dropdown-item">Releasing to OperatorHub.io</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Application/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/herve4m/quay-api-operator/edit/main/docs/crds/ApiToken.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#apitoken-create-oauth-access-tokens-for-accessing-the-quay-container-registry-api" class="nav-link">ApiToken - Create OAuth access tokens for accessing the Quay Container Registry API</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#usage-example" class="nav-link">Usage Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#properties" class="nav-link">Properties</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="3"><a href="#clientid" class="nav-link">clientId</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#clientidfrom" class="nav-link">clientIdFrom</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#clientidfromkey" class="nav-link">clientIdFrom.key</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#clientidfromname" class="nav-link">clientIdFrom.name</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#clientidfromnamespace" class="nav-link">clientIdFrom.namespace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#connsecretref" class="nav-link">connSecretRef</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#connsecretrefname" class="nav-link">connSecretRef.name</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#connsecretrefnamespace" class="nav-link">connSecretRef.namespace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#foruser" class="nav-link">forUser</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#preserveinquayondeletion" class="nav-link">preserveInQuayOnDeletion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretref" class="nav-link">retSecretRef</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretrefname" class="nav-link">retSecretRef.name</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretrefnamespace" class="nav-link">retSecretRef.namespace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#rights" class="nav-link">rights</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#listing-the-apitoken-resources" class="nav-link">Listing the ApiToken Resources</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<!---
DO NOT EDIT THIS FILE, BECAUSE IT IS AUTOMATICALLY GENERATED FROM A TEMPLATE.
Instead, edit the scripts/templates/docs/api.md.jinja template, and then run
the scripts/crd2markdown script.
--->

<h1 id="apitoken-create-oauth-access-tokens-for-accessing-the-quay-container-registry-api">ApiToken - Create OAuth access tokens for accessing the Quay Container Registry API</h1>
<p>The ApiToken custom resource relies on a Secret resource to provide the connection parameters to the Quay instance.
This Secret resource must include the following data:</p>
<ul>
<li><code>host</code>: URL for accessing the Quay API, such as <code>https://quay.example.com:8443</code> for example.</li>
<li><code>validateCerts</code>: Whether to allow insecure connections to the API.
  By default, insecure connections are refused.</li>
<li><code>username</code>: The username to use for authenticating against the API.</li>
<li><code>password</code>: The password to use for authenticating against the API.</li>
</ul>
<p>In contrast to the other custom resources, you cannot authenticate by using an existing OAuth access token, and the secret must provide the <code>username</code> and the <code>password</code> parameters.
The OAuth access token that the ApiToken custom resource generates acts on behalf of the user account that you use in this secret.</p>
<p>You can create the secret by using the <code>kubectl create secret</code> command:</p>
<pre><code class="language-sh">kubectl create secret generic quay-credentials --from-literal host=https://quay.example.com:8443 --from-literal validateCerts=false --from-literal username=admin --from-literal password=Sup3r53cr3L
</code></pre>
<p>Or you can create the secret from a resource file:</p>
<pre><code class="language-yaml">---
apiVersion: v1
kind: Secret
metadata:
  name: quay-credentials
stringData:
  host: https://quay.example.com:8443
  validateCerts: &quot;false&quot;
  username: admin
  password: Sup3r53cr3L
</code></pre>
<p>You refer to this secret in your ApiToken custom resource by using the <code>connSecretRef</code> property.
See the <a href="#usage-example">usage example</a>.</p>
<p>The ApiToken custom resource generates an OAuth access token for authenticating against the API, and stores it in the Secret resource that you specify by using the <a href="#retsecretref">retSecretRef</a> property.
You can use that secret as an input for other custom resources, by specifying it in the <code>connSecretRef</code> property of these resources.</p>
<h2 id="usage-example">Usage Example</h2>
<pre><code class="language-yaml">---
apiVersion: quay.herve4m.github.io/v1alpha1
kind: ApiToken
metadata:
  name: apitoken-sample
spec:
  # Connection parameters in a Secret resource
  # The secret MUST include the &quot;username&quot; and &quot;password&quot; parameters, because
  # you cannot authenticate with a token to create another token.
  connSecretRef:
    name: quay-credentials
    # By default, the operator looks for the secret in the same namespace as
    # the apitoken resource, but you can specify a different namespace.
    # namespace: mynamespace

  # You can specify the client ID by using the clientId parameter, or you can
  # refer to a secret that stores the ID by using the clientIdFrom parameter.
  # The application resource can create such secret.
  # clientId: PZ6F80R1LCVPGYNZGSZQ
  clientIdFrom:
    name: application-secret
    key: clientId
    # namespace: mynamespace

  rights:
    - all
    # - org:admin
    # - user:admin

  # The Secret resource is created or updated, and stores the &quot;accessToken&quot;
  # parameter.
  # &quot;host&quot;, &quot;validateCerts&quot;, and &quot;token&quot; parameters are also added, so that
  # you can use the secret with other Quay resources to access the API.
  retSecretRef:
    name: quay-credentials-secret
    # By default, the operator stores the secret in the same namespace as the
    # apitoken resource, but you can specify a different namespace.
    # namespace: mynamespace

</code></pre>
<h2 id="properties">Properties</h2>
<h3 id="clientid">clientId</h3>
<p>The client ID associated with the OAuth application to use for generating the OAuth access token. See the Application resource to create an application object and to retrieve the associated client ID.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="clientidfrom">clientIdFrom</h3>
<p>Reference to the secret resource that stores the client ID of the application.
You specify the key that stores this client ID by using the <code>key</code> parameter. By default the operator looks for a <code>clientId</code> key in the secret.
Mutually exclusive with <code>clientId</code>.</p>
<p><strong>Type</strong>: object (see the following properties)</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="clientidfromkey">clientIdFrom.key</h3>
<p>In the secret resource, key that stores the client ID.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: clientId</p>
<h3 id="clientidfromname">clientIdFrom.name</h3>
<p>Name of the secret resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="clientidfromnamespace">clientIdFrom.namespace</h3>
<p>Namespace of the secret resource. By default, the secret resource is retrieved from the same namespace as the current ApiToken resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="connsecretref">connSecretRef</h3>
<p>Reference to the secret resource that stores the connection parameters to the Quay Container Registry API.
The secret must include the <code>host</code>, <code>token</code> (or <code>username</code> and <code>password</code>), and optionally the <code>validateCerts</code> keys.</p>
<p><strong>Type</strong>: object (see the following properties)</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="connsecretrefname">connSecretRef.name</h3>
<p>Name of the secret resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="connsecretrefnamespace">connSecretRef.namespace</h3>
<p>Namespace of the secret resource. By default, the secret resource is retrieved from the same namespace as the current ApiToken resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="foruser">forUser</h3>
<p>The username to generate an OAuth access token for. The user receives a notification in the web interface, which enables the user to retrieve the token. When you use this option, the resource does not return the token. Requires Quay version 3.12 or later.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="preserveinquayondeletion">preserveInQuayOnDeletion</h3>
<p>Whether to preserve the corresponding Quay object when you delete the ApiToken resource. When set to <code>false</code> (the default), the object is deleted from Quay.</p>
<p><strong>Type</strong>: boolean</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: False</p>
<h3 id="retsecretref">retSecretRef</h3>
<p>RetSecretRef is the secret resource that the ApiToken resource creates. This secret will store the data that the resource generates:</p>
<ul>
<li>accessToken - The OAuth access token.</li>
<li>token - The OAuth access token (copy).</li>
<li>host - URL for accessing the Quay API.</li>
<li>validateCerts - Whether to allow insecure connections to the API.</li>
</ul>
<p><strong>Type</strong>: object (see the following properties)</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="retsecretrefname">retSecretRef.name</h3>
<p>Name of the secret resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="retsecretrefnamespace">retSecretRef.namespace</h3>
<p>Namespace of the secret resource. By default, the secret resource is created in the same namespace as the current ApiToken resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="rights">rights</h3>
<p>List of permissions to grant to the user account. <code>all</code> means all the permissions.</p>
<p><strong>Type</strong>: array</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: ['repo:read']</p>
<h2 id="listing-the-apitoken-resources">Listing the ApiToken Resources</h2>
<p>You can retrieve the list of the ApiToken custom resources in a namespace by using the <code>kubectl get</code> command:</p>
<pre><code class="language-sh">kubectl get apitokens.quay.herve4m.github.io -n &lt;namespace&gt;
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
