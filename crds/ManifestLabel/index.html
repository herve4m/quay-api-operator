<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>ManifestLabel - API Operator for Quay</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">API Operator for Quay</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">User Guide</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Custom Resources</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Operator Custom Resources</a>
</li>
                                    
<li>
    <a href="../ApiToken/" class="dropdown-item">ApiToken</a>
</li>
                                    
<li>
    <a href="../Application/" class="dropdown-item">Application</a>
</li>
                                    
<li>
    <a href="../DefaultPerm/" class="dropdown-item">DefaultPerm</a>
</li>
                                    
<li>
    <a href="../DockerToken/" class="dropdown-item">DockerToken</a>
</li>
                                    
<li>
    <a href="../FirstUser/" class="dropdown-item">FirstUser</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">ManifestLabel</a>
</li>
                                    
<li>
    <a href="../Message/" class="dropdown-item">Message</a>
</li>
                                    
<li>
    <a href="../Notification/" class="dropdown-item">Notification</a>
</li>
                                    
<li>
    <a href="../OrganizationPrune/" class="dropdown-item">OrganizationPrune</a>
</li>
                                    
<li>
    <a href="../Organization/" class="dropdown-item">Organization</a>
</li>
                                    
<li>
    <a href="../ProxyCache/" class="dropdown-item">ProxyCache</a>
</li>
                                    
<li>
    <a href="../Quota/" class="dropdown-item">Quota</a>
</li>
                                    
<li>
    <a href="../Repository/" class="dropdown-item">Repository</a>
</li>
                                    
<li>
    <a href="../RepositoryMirror/" class="dropdown-item">RepositoryMirror</a>
</li>
                                    
<li>
    <a href="../RepositoryPrune/" class="dropdown-item">RepositoryPrune</a>
</li>
                                    
<li>
    <a href="../Robot/" class="dropdown-item">Robot</a>
</li>
                                    
<li>
    <a href="../Tag/" class="dropdown-item">Tag</a>
</li>
                                    
<li>
    <a href="../TeamLdap/" class="dropdown-item">TeamLdap</a>
</li>
                                    
<li>
    <a href="../TeamOidc/" class="dropdown-item">TeamOidc</a>
</li>
                                    
<li>
    <a href="../Team/" class="dropdown-item">Team</a>
</li>
                                    
<li>
    <a href="../User/" class="dropdown-item">User</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Developer Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../developer-guide/" class="dropdown-item">Developer Guide</a>
</li>
                                    
<li>
    <a href="../../developer-guide/tools/" class="dropdown-item">Tools</a>
</li>
                                    
<li>
    <a href="../../developer-guide/building/" class="dropdown-item">Building</a>
</li>
                                    
<li>
    <a href="../../developer-guide/deploying/" class="dropdown-item">Deploying</a>
</li>
                                    
<li>
    <a href="../../developer-guide/testing/" class="dropdown-item">Testing</a>
</li>
                                    
<li>
    <a href="../../developer-guide/releasing/" class="dropdown-item">Releasing to OperatorHub.io</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../FirstUser/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Message/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/herve4m/quay-api-operator/edit/main/docs/crds/ManifestLabel.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#manifestlabel-manage-quay-container-registry-image-manifest-labels" class="nav-link">ManifestLabel - Manage Quay Container Registry image manifest labels</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#usage-example" class="nav-link">Usage Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#properties" class="nav-link">Properties</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="3"><a href="#connsecretref" class="nav-link">connSecretRef</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#connsecretrefname" class="nav-link">connSecretRef.name</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#connsecretrefnamespace" class="nav-link">connSecretRef.namespace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#image" class="nav-link">image</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#key" class="nav-link">key</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#preserveinquayondeletion" class="nav-link">preserveInQuayOnDeletion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#replace" class="nav-link">replace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretref" class="nav-link">retSecretRef</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretrefname" class="nav-link">retSecretRef.name</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#retsecretrefnamespace" class="nav-link">retSecretRef.namespace</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="3"><a href="#value" class="nav-link">value</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#listing-the-manifestlabel-resources" class="nav-link">Listing the ManifestLabel Resources</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<!---
DO NOT EDIT THIS FILE, BECAUSE IT IS AUTOMATICALLY GENERATED FROM A TEMPLATE.
Instead, edit the scripts/templates/docs/api.md.jinja template, and then run
the scripts/crd2markdown script.
--->

<h1 id="manifestlabel-manage-quay-container-registry-image-manifest-labels">ManifestLabel - Manage Quay Container Registry image manifest labels</h1>
<p>The ManifestLabel custom resource relies on a Secret resource to provide the connection parameters to the Quay instance.
This Secret resource must include the following data:</p>
<ul>
<li><code>host</code>: URL for accessing the Quay API, such as <code>https://quay.example.com:8443</code> for example.</li>
<li><code>validateCerts</code>: Whether to allow insecure connections to the API.
  By default, insecure connections are refused.</li>
<li><code>token</code>: OAuth access token for authenticating against the API.
  To create such a token see the <a href="https://access.redhat.com/documentation/en-us/red_hat_quay/3/html-single/red_hat_quay_api_guide/index#creating-oauth-access-token">Creating an OAuth Access Token</a> documentation.
  You can also use the <a href="../ApiToken/">ApiToken</a> custom resource to create this token.</li>
<li><code>username</code>: The username to use for authenticating against the API.
  If <code>token</code> is set, then <code>username</code> is ignored.</li>
<li><code>password</code>: The password to use for authenticating against the API.
  If <code>token</code> is set, then <code>password</code> is ignored.</li>
</ul>
<p>You can create the secret by using the <code>kubectl create secret</code> command:</p>
<pre><code class="language-sh">kubectl create secret generic quay-credentials --from-literal host=https://quay.example.com:8443 --from-literal validateCerts=false --from-literal token=vFYyU2D0fHYXvcA3Y5TYfMrIMyVIH9YmxoVLsmku
</code></pre>
<p>Or you can create the secret from a resource file:</p>
<pre><code class="language-yaml">---
apiVersion: v1
kind: Secret
metadata:
  name: quay-credentials
stringData:
  host: https://quay.example.com:8443
  validateCerts: &quot;false&quot;
  token: vFYyU2D0fHYXvcA3Y5TYfMrIMyVIH9YmxoVLsmku
</code></pre>
<p>You refer to this secret in your ManifestLabel custom resource by using the <code>connSecretRef</code> property.
See the <a href="#usage-example">usage example</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not delete the Secret resource if a Quay custom resource still references it.
If you delete the Secret resource, then the Operator cannot connect to the Quay API anymore, and cannot synchronize the Quay custom resource with its corresponding object in Quay.
In addition, deleting the Quay custom resource does not complete because the Operator cannot delete the corresponding object in Quay.</p>
<p>If you face this issue, then edit the custom resource (<code>kubectl edit</code>), and set the <a href="#preserveinquayondeletion">.spec.preserveInQuayOnDeletion</a> property to <code>true</code>.
Alternatively, you can remove the <code>.metadata.finalizers</code> section.
In both case, you must manually delete the corresponding object in Quay.</p>
</div>
<h2 id="usage-example">Usage Example</h2>
<pre><code class="language-yaml">---
apiVersion: quay.herve4m.github.io/v1alpha1
kind: ManifestLabel
metadata:
  name: manifestlabel-sample
spec:
  # Connection parameters in a Secret resource
  connSecretRef:
    name: quay-credentials
    # By default, the operator looks for the secret in the same namespace as
    # the manifestlabel resource, but you can specify a different namespace.
    # namespace: mynamespace

  # Whether to preserve the corresponding Quay object when you
  # delete the ManifestLabel resource.
  preserveInQuayOnDeletion: false

  image: production/smallimage:v1.4.3
  key: component
  value: front
  replace: true

  # The Secret resource is created or updated, and stores the returned data.
  # Some details of the manifest label are stored in this secret.
  retSecretRef:
    name: manifestlabel-sample-ret-secret
    # By default, the operator stores the secret in the same namespace as the
    # manifestlabel resource, but you can specify a different namespace.
    # namespace: mynamespace

</code></pre>
<h2 id="properties">Properties</h2>
<h3 id="connsecretref">connSecretRef</h3>
<p>Reference to the secret resource that stores the connection parameters to the Quay Container Registry API.
The secret must include the <code>host</code>, <code>token</code> (or <code>username</code> and <code>password</code>), and optionally the <code>validateCerts</code> keys.</p>
<p><strong>Type</strong>: object (see the following properties)</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="connsecretrefname">connSecretRef.name</h3>
<p>Name of the secret resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="connsecretrefnamespace">connSecretRef.namespace</h3>
<p>Namespace of the secret resource. By default, the secret resource is retrieved from the same namespace as the current ManifestLabel resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="image">image</h3>
<p>Manifest to update. The format is <code>namespace</code>/<code>repository</code>:<code>tag</code> or <code>namespace</code>/<code>repository</code>@<code>digest</code>. The namespace can be an organization or a personal namespace. If you omit the namespace part, then the resource looks for the repository in your personal namespace. If you omit the tag and the digest part, then <code>latest</code> is assumed.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="key">key</h3>
<p>Label's key.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="preserveinquayondeletion">preserveInQuayOnDeletion</h3>
<p>Whether to preserve the corresponding Quay object when you delete the ManifestLabel resource. When set to <code>false</code> (the default), the object is deleted from Quay.</p>
<p><strong>Type</strong>: boolean</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: False</p>
<h3 id="replace">replace</h3>
<p>Only used when <code>state=present</code>. If <code>true</code>, then the resource deletes all the labels that use the key you define in the <code>key</code> parameter before adding the new label. If <code>false</code>, then the resource adds the new label even if existing labels already use the key you define in the <code>key</code> parameter. Quay supports multiple labels with the same key.</p>
<p><strong>Type</strong>: boolean</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: True</p>
<h3 id="retsecretref">retSecretRef</h3>
<p>RetSecretRef is the secret resource that the ManifestLabel resource creates. This secret will store the data that the resource generates:</p>
<ul>
<li>id - Internal identifier of the label.</li>
<li>key - Label's key.</li>
<li>mediaType - Format of the label (<code>text/plain</code> or <code>application/json</code>).</li>
<li>sourceType - Whether the label has been set by the Containerfile/Dockerfile manifest (<code>manifest</code>), or by an API call or from the web UI (<code>api</code>). Labels set in Containerfile/Dockerfile manifests are read-only.</li>
<li>value - Label's value.</li>
</ul>
<p><strong>Type</strong>: object (see the following properties)</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="retsecretrefname">retSecretRef.name</h3>
<p>Name of the secret resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: True</p>
<p><strong>Default value</strong>: None</p>
<h3 id="retsecretrefnamespace">retSecretRef.namespace</h3>
<p>Namespace of the secret resource. By default, the secret resource is created in the same namespace as the current ManifestLabel resource.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h3 id="value">value</h3>
<p>Label<code>s value. Required when</code>state=present'.</p>
<p><strong>Type</strong>: string</p>
<p><strong>Required</strong>: False</p>
<p><strong>Default value</strong>: None</p>
<h2 id="listing-the-manifestlabel-resources">Listing the ManifestLabel Resources</h2>
<p>You can retrieve the list of the ManifestLabel custom resources in a namespace by using the <code>kubectl get</code> command:</p>
<pre><code class="language-sh">kubectl get manifestlabels.quay.herve4m.github.io -n &lt;namespace&gt;
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
